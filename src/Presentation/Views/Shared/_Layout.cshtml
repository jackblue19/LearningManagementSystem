<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="color-scheme" content="light" />
    <title>@ViewData["Title"] - Learning Management System</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca'
                        }
                    },
                    fontFamily: {
                        sans: ['"Inter"', 'system-ui', 'Segoe UI', 'sans-serif']
                    }
                }
            }
        };
    </script>

    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
</head>

@{
    var layoutVariant = (ViewData["LayoutVariant"] as string ?? "app").ToLowerInvariant();
    var isStandalone = layoutVariant == "standalone";
    var currentArea = ViewContext.RouteData.Values["area"]?.ToString() ?? string.Empty;
    var currentPage = ViewContext.RouteData.Values["page"]?.ToString() ?? string.Empty;

    var navigationItems = new[]
    {
        new { Title = "Dashboard", Area = "Admin", Page = "/Dashboard", Icon = "M4 6h16M4 12h16M4 18h16" },
        new { Title = "Classes", Area = "Admin", Page = "/Classes/Index", Icon = "M4 6h16v12H4z" },
        new { Title = "Subjects", Area = "Admin", Page = "/Subjects/Index", Icon = "M5 8h14M5 12h14M5 16h10" },
        new { Title = "Exams", Area = "Admin", Page = "/Exams/Index", Icon = "M8 7h8l2 4-2 4H8L6 11l2-4z" },
        new { Title = "Payments", Area = "Admin", Page = "/Payments/Index", Icon = "M5 7h14v10H5z" },
        new { Title = "Users", Area = "Admin", Page = "/Users/Index", Icon = "M12 7a3 3 0 1 1-3 3 3 3 0 0 1 3-3Zm0 6c-3.333 0-6 1.333-6 4v1h12v-1c0-2.667-2.667-4-6-4z" }
    };

    string NavClasses(string area, string page)
    {
        var isActive = string.Equals(currentArea, area, StringComparison.OrdinalIgnoreCase) && string.Equals(currentPage, page, StringComparison.OrdinalIgnoreCase);
        var baseClasses = "flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-600";
        return isActive
            ? $"{baseClasses} bg-brand-50 text-brand-700"
            : $"{baseClasses} text-slate-600 hover:bg-slate-100 hover:text-slate-900";
    }
}

<body class="bg-slate-50 font-sans text-slate-900 antialiased">
    @if (isStandalone)
    {
        <div class="flex min-h-screen flex-col">
            <header class="border-b border-slate-200 bg-white">
                <div class="mx-auto flex h-16 w-full max-w-5xl items-center justify-between px-4 sm:px-6">
                    <a class="flex items-center gap-2 font-semibold text-slate-900" asp-area="" asp-controller="Home" asp-action="Index">
                        <span class="flex h-9 w-9 items-center justify-center rounded-lg bg-brand-600 text-sm font-bold text-white">L</span>
                        <span>Learning Management System</span>
                    </a>
                    <a class="text-sm font-medium text-brand-600 hover:text-brand-700" asp-area="Shared" asp-page="/Auth/Login">Back to sign in</a>
                </div>
            </header>
            <main class="flex flex-1 items-center justify-center px-4 py-12 sm:px-6 lg:px-8">
                @RenderBody()
            </main>
        </div>
    }
    else
    {
        <div class="min-h-screen">
            <div data-drawer-backdrop class="hidden fixed inset-0 z-30 bg-slate-900/40 backdrop-blur-sm lg:hidden"></div>

            <aside data-drawer class="drawer fixed inset-y-0 left-0 z-40 hidden w-64 flex-col border-r border-slate-200 bg-white shadow-xl lg:static lg:flex lg:shadow-none">
                <div class="flex h-16 items-center gap-2 px-6">
                    <span class="flex h-9 w-9 items-center justify-center rounded-lg bg-brand-600 text-sm font-bold text-white">L</span>
                    <div>
                        <p class="text-sm font-semibold text-slate-900">LMS Platform</p>
                        <p class="text-xs text-slate-500">Modern learning ops</p>
                    </div>
                    <button type="button" data-drawer-close class="ml-auto inline-flex h-9 w-9 items-center justify-center rounded-md border border-slate-200 text-slate-600 transition hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-600 lg:hidden" aria-label="Close navigation">
                        <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                            <path d="M6 6l12 12M18 6l-12 12" stroke-linecap="round" stroke-linejoin="round"></path>
                        </svg>
                    </button>
                </div>
                <nav class="flex-1 overflow-y-auto px-4 py-6">
                    <p class="px-3 text-xs font-semibold uppercase tracking-wide text-slate-500">Administration</p>
                    <ul class="mt-3 space-y-1">
                        @foreach (var item in navigationItems)
                        {
                            <li>
                                <a class="@NavClasses(item.Area, item.Page)" asp-area="@item.Area" asp-page="@item.Page">
                                    <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path d="@item.Icon" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                    <span>@item.Title</span>
                                </a>
                            </li>
                        }
                    </ul>

                    <p class="mt-8 px-3 text-xs font-semibold uppercase tracking-wide text-slate-500">Role workspaces</p>
                    <ul class="mt-3 space-y-1">
                        <li><a class="@NavClasses("Teachers", "/Dashboard")" asp-area="Teachers" asp-page="/Dashboard">Teacher dashboard</a></li>
                        <li><a class="@NavClasses("Teachers", "/ManageClass")" asp-area="Teachers" asp-page="/ManageClass">Manage classes</a></li>
                        <li><a class="@NavClasses("Students", "/Dashboard")" asp-area="Students" asp-page="/Dashboard">Student dashboard</a></li>
                        <li><a class="@NavClasses("CentreManagement", "/Dashboard")" asp-area="CentreManagement" asp-page="/Dashboard">Centre management</a></li>
                    </ul>
                </nav>
                <div class="border-t border-slate-200 p-4 text-xs text-slate-500">
                    <div class="flex items-center justify-between">
                        <a asp-area="Shared" asp-page="/Auth/AccessDenied" class="font-semibold text-slate-700 hover:text-brand-600">Access policy</a>
                        <a asp-area="Shared" asp-page="/Auth/Login" class="rounded-md border border-slate-200 px-3 py-1 text-xs font-medium text-slate-700 hover:border-brand-300 hover:text-brand-700">Sign in</a>
                    </div>
                </div>
            </aside>

            <div class="flex min-h-screen flex-col bg-slate-50 lg:ml-64">
                <header class="sticky top-0 z-20 border-b border-slate-200 bg-white">
                    <div class="mx-auto flex h-16 w-full max-w-7xl items-center justify-between px-4 sm:px-6 lg:px-8">
                        <div class="flex items-center gap-3">
                            <button type="button" data-drawer-toggle class="inline-flex h-10 w-10 items-center justify-center rounded-md border border-slate-200 text-slate-700 shadow-sm transition hover:bg-slate-50 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-600 lg:hidden" aria-label="Open navigation">
                                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                    <path d="M4 7h16M4 12h16M4 17h16" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                            </button>
                            <div>
                                <p class="text-sm font-semibold text-slate-900">@ViewData["Title"]</p>
                                <p class="text-xs text-slate-500">@DateTime.UtcNow.ToString("dddd, MMM dd")</p>
                            </div>
                        </div>
                        <div class="flex items-center gap-3">
                            <form class="relative" role="search">
                                <label class="sr-only" for="global-search">Search</label>
                                <input id="global-search" name="q" type="search" placeholder="Search" class="w-48 rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 shadow-sm transition focus:border-brand-400 focus:outline-none focus:ring-2 focus:ring-brand-100 sm:w-64" />
                                <span class="pointer-events-none absolute inset-y-0 right-3 flex items-center text-slate-400">
                                    <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                        <path d="M11 5a6 6 0 1 1-3.84 10.56l-2.6 2.6" stroke-linecap="round" stroke-linejoin="round"></path>
                                    </svg>
                                </span>
                            </form>
                            <a asp-area="Shared" asp-page="/Auth/Register" class="hidden items-center gap-2 rounded-lg border border-slate-200 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:border-brand-300 hover:text-brand-700 sm:inline-flex">Invite user</a>
                            <button type="button" class="inline-flex h-10 w-10 items-center justify-center rounded-full border border-slate-200 text-slate-600 transition hover:border-brand-300 hover:text-brand-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-600" aria-label="User menu">
                                <svg class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
                                    <path d="M12 7a3 3 0 1 1-3 3 3 3 0 0 1 3-3Zm0 6c-3.333 0-6 1.333-6 4v1h12v-1c0-2.667-2.667-4-6-4z" stroke-linecap="round" stroke-linejoin="round"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </header>

                <main class="flex-1">
                    <div class="mx-auto w-full max-w-7xl px-4 py-10 sm:px-6 lg:px-8">
                        @RenderBody()
                    </div>
                </main>
            </div>
        </div>
    }

    <script>
        (function () {
            const drawer = document.querySelector('[data-drawer]');
            const toggle = document.querySelector('[data-drawer-toggle]');
            const close = document.querySelector('[data-drawer-close]');
            const backdrop = document.querySelector('[data-drawer-backdrop]');

            if (!drawer) {
                return;
            }

            const closeDrawer = () => {
                drawer.classList.add('hidden');
                drawer.classList.remove('flex');
                if (backdrop) {
                    backdrop.classList.add('hidden');
                }
            };

            const openDrawer = () => {
                drawer.classList.remove('hidden');
                drawer.classList.add('flex');
                if (backdrop) {
                    backdrop.classList.remove('hidden');
                }
            };

            toggle?.addEventListener('click', () => {
                if (drawer.classList.contains('hidden')) {
                    openDrawer();
                } else {
                    closeDrawer();
                }
            });

            close?.addEventListener('click', closeDrawer);
            backdrop?.addEventListener('click', closeDrawer);

            window.matchMedia('(min-width: 1024px)').addEventListener('change', (event) => {
                if (event.matches) {
                    drawer.classList.remove('hidden');
                    drawer.classList.add('flex');
                    backdrop?.classList.add('hidden');
                } else {
                    closeDrawer();
                }
            });
        })();
    </script>

    <script src="_framework/blazor.server.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>